(this["webpackJsonptrivia-test"]=this["webpackJsonptrivia-test"]||[]).push([[0],{43:function(e,t,a){e.exports=a(80)},48:function(e,t,a){},55:function(e,t){},80:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(27),s=a.n(c),i=(a(48),a(11)),o=a(21),l=a(13),u=a(23),m=a(12),d=a.n(m),p=a(5),h=a(6),b=a(8),f=a(7),E=a(4),g=a(9),y=a(3),v=function(e){return{type:"FAIL_REQUEST_QUESTIONS",payload:e}},O=function(e){return{type:"FAIL_REQUEST",payload:e}},k=a(29),N=function(e,t,a){return{type:"NEW_RANK",name:e,score:t,picture:a}},j=function(e){return{type:"RECEIVE_CATEGORIES_ERROR",payload:e}},S=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(b.a)(this,Object(f.a)(t).call(this,e))).state={name:"",email:"",canLogin:!1,shouldRedirectToGame:!1,shouldRedirectToConf:!1,btnClass:"btn btn-light"},a.handleChange=a.handleChange.bind(Object(E.a)(a)),a.renderButton=a.renderButton.bind(Object(E.a)(a)),a}return Object(g.a)(t,e),Object(h.a)(t,[{key:"onSubmit",value:function(e){var t,a,n,r,c,s,i;return d.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:e.preventDefault(),t=this.props,a=t.fetchToken,n=t.nameAndEmail,r=t.score,c=this.state,s=c.name,i=c.email,a(),n(s,i,r),this.setState({shouldRedirectToGame:!0});case 6:case"end":return o.stop()}}),null,this)}},{key:"handleChange",value:function(e){var t=this,a=e.target;this.setState(Object(u.a)({},a.name,a.value),(function(){return t.authenticator()}))}},{key:"authenticator",value:function(){var e=this.state,t=e.name,a=e.email,n=/^[a-z0-9_.]+@[a-z0-9]+\.[a-z]{2,3}(?:\.[a-z]{2})?$/;this.setState({canLogin:n.test(a)&&t.length>0}),n.test(a)&&t.length>0?this.setState({btnClass:"btn btn-info"}):this.setState({btnClass:"btn btn-light"}),this.onSubmit=this.onSubmit.bind(this)}},{key:"renderButton",value:function(){var e=this,t=this.state,a=t.canLogin,n=t.btnClass;return r.a.createElement("div",{className:"buttons row"},r.a.createElement("button",{disabled:!a,type:"submit","data-testid":"btn-play",className:n},"Jogar"),r.a.createElement("button",{type:"button","data-testid":"btn-settings",onClick:function(){return e.setState({shouldRedirectToConf:!0})},className:"btn btn-dark"},"Configura\xe7\xf5es"))}},{key:"render",value:function(){var e=this.state,t=e.name,a=e.email,n=e.shouldRedirectToGame,c=e.shouldRedirectToConf;return n?r.a.createElement(l.a,{to:"/game"}):c?r.a.createElement(l.a,{to:"/settings"}):r.a.createElement("main",{className:"login-page row  align-items-center"},r.a.createElement("h1",null,"TRIVIA",r.a.createElement("h3",null,"REACT REDUX")),r.a.createElement("form",{className:"container",action:"GET",onSubmit:this.onSubmit},r.a.createElement("div",{className:"row"},r.a.createElement("label",{htmlFor:"name-input",className:"form-label"},"Nome",r.a.createElement("input",{type:"text",value:t,name:"name",id:"name-input",onChange:this.handleChange,"data-testid":"input-player-name",className:"form-control"}))),r.a.createElement("div",{className:"row"},r.a.createElement("label",{htmlFor:"email-input",className:"form-label"},"Email",r.a.createElement("input",{type:"email",value:a,name:"email",id:"email-input",onChange:this.handleChange,"data-testid":"input-gravatar-email",className:"form-control"}))),this.renderButton()))}}]),t}(n.Component),w=Object(i.b)((function(e){return{score:e.game.score}}),(function(e){return{fetchToken:function(){return e((function(e){var t,a;return d.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return e({type:"REQUEST_TOKEN"}),n.prev=2,n.next=5,d.a.awrap(fetch("https://opentdb.com/api_token.php?command=request"));case 5:return t=n.sent,n.next=8,d.a.awrap(t.json());case 8:a=n.sent,e({type:"RECEIVE_TOKEN",payload:a.token}),localStorage.setItem("token",a.token),n.next=16;break;case 13:n.prev=13,n.t0=n.catch(2),e(O(n.t0));case 16:case"end":return n.stop()}}),null,null,[[2,13]])}))},nameAndEmail:function(t,a,n){return e(function(e,t,a){return function(n){n(function(e,t){return{type:"GET_NAME_EMAIL",name:e,email:t}}(e,t)),localStorage.setItem("state",JSON.stringify({player:{name:e,gravatarEmail:t,score:a,assertions:0}}))}}(t,a,n))}}}))(S),C=function(e){function t(){var e;return Object(p.a)(this,t),(e=Object(b.a)(this,Object(f.a)(t).call(this))).state={index:0,disabled:!1,timer:30,showNext:!1,score:0,shouldRedirect:!1,showAnswers:!1},e.four=4,e.ten=10,e.handleClick=e.handleClick.bind(Object(E.a)(e)),e.timerFunction=e.timerFunction.bind(Object(E.a)(e)),e.timerEnd=e.timerEnd.bind(Object(E.a)(e)),e.clickNext=e.clickNext.bind(Object(E.a)(e)),e.updateScore=e.updateScore.bind(Object(E.a)(e)),e}return Object(g.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this.timerFunction(),this.timerEnd()}},{key:"handleClick",value:function(e,t){clearInterval(this.countdown),clearTimeout(this.timeOut);this.setState({disabled:!0,showNext:!0,showAnswers:!0},this.updateScore({hard:3,medium:2,easy:1}[t],e))}},{key:"updateScore",value:function(e,t){var a=this.state.timer,n=this.state.score,r=this.props.scoreUpdater,c=n+this.ten+a*e;t.classList.contains("true")&&(this.setState({score:c}),r(c))}},{key:"timerEnd",value:function(){var e=this;this.timeOut=setTimeout((function(){e.setState({disabled:!0,showNext:!0,showAnswers:!0},clearInterval(e.countdown))}),30005)}},{key:"timerFunction",value:function(){var e=this;this.countdown=setInterval((function(){e.setState((function(e){if(e.timer>0)return Object(y.a)({},e,{timer:e.timer-1})}))}),1e3)}},{key:"clickNext",value:function(){var e=this.state.index;e<this.four?this.setState({index:e+1,showAnswers:!1,showNext:!1,disabled:!1,timer:30}):this.setState({shouldRedirect:!0}),this.timerEnd(),this.timerFunction()}},{key:"render",value:function(){var e=this,t=this.state,a=t.index,n=t.disabled,c=t.timer,s=t.showNext,i=t.shouldRedirect,o=t.showAnswers;if(i)return r.a.createElement(l.a,{to:"/feedbacks"});var u=this.props.questions;return r.a.createElement("main",{className:"game-container position-absolute d-flex flex-column"},r.a.createElement("h2",{className:"position-absolute timer"},r.a.createElement("p",null,c)),r.a.createElement("h2",{"data-testid":"question-category",className:"category"},atob(u[a].category)),r.a.createElement("h4",{"data-testid":"question-text",className:"question"},atob(u[a].question)),u[a].alternatives.map((function(t,c){var s=t.answer,i=t.isCorrect,l=t.testid,m=t.className;return r.a.createElement("button",{type:"button",key:"answer-".concat(c),"data-testid":l,className:o?"".concat(m," ").concat(i):"".concat(i," btn btn-secondary"),disabled:n,onClick:function(t){var n=t.target;return e.handleClick(n,atob(u[a].difficulty))}},atob(s))})),s&&r.a.createElement("button",{"data-testid":"btn-next",type:"button",onClick:this.clickNext,className:"position-absolute btn-next btn btn-dark"},a<this.four?"Pr\xf3xima":"Finalizar"))}}]),t}(r.a.Component),R=Object(i.b)((function(e){return{name:e.player.name,email:e.player.email}}),(function(e){return{scoreUpdater:function(t){return e(function(e){return function(t){t({type:"UPDATE_SCORE",payload:e}),t({type:"INCREASE_ASSERTIONS"});var a=localStorage.getItem("state"),n=JSON.parse(a),r=Object(y.a)({},n.player,{score:n.player.score+e,assertions:n.player.assertions+1});localStorage.setItem("state",JSON.stringify({player:r}))}}(t))}}}))(C),T=a(18),x=a.n(T),I=function(e){function t(){return Object(p.a)(this,t),Object(b.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this.props,t=e.name,a=e.email,n=e.score,c=e.location,s=x()(a).toString();return r.a.createElement("header",{className:"fixed-top row justify-content-center align-items-center"},r.a.createElement("h1",{className:"header-title position-absolute"},"TRIVIA"),r.a.createElement("img",{"data-testid":"header-profile-picture",src:"https://www.gravatar.com/avatar/".concat(s),alt:"avatar"}),r.a.createElement("h4",{className:"header-name","data-testid":"header-player-name"},t),"ranking"===c?null:r.a.createElement("h4",{className:"header-score position-absolute","data-testid":"header-score"},"Pontua\xe7\xe3o:",n))}}]),t}(n.Component),_=Object(i.b)((function(e){return{name:e.player.name,email:e.player.email,score:e.game.score}}))(I),A=function(e){function t(){return Object(p.a)(this,t),Object(b.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){return r.a.createElement("main",{className:"loading-screen row"},r.a.createElement("h1",null,"Loading"),r.a.createElement("div",{className:"lds-ellipsis"},r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null)))}}]),t}(n.Component),U=function(e){function t(){var e;return Object(p.a)(this,t),(e=Object(b.a)(this,Object(f.a)(t).call(this))).randomizer=e.randomizer.bind(Object(E.a)(e)),e}return Object(g.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.token;(0,e.getQuestions)(t,e.parameters),JSON.parse(localStorage.getItem("ranking"))||localStorage.setItem("ranking",JSON.stringify([]))}},{key:"randomizer",value:function(e){return e.map((function(e){return{question:e.question,category:e.category,difficulty:e.difficulty,alternatives:[].concat(Object(k.a)(e.incorrect_answers.map((function(e,t){return{answer:e,testid:"wrong-answer-".concat(t),className:"btn btn-danger",isCorrect:!1}}))),[{answer:e.correct_answer,testid:"correct-answer",className:"btn btn-success",isCorrect:!0}]).sort((function(){return Math.random()-.5}))}}))}},{key:"render",value:function(){var e=this.props.questions;return e.length?r.a.createElement("main",{className:"game-page d-flex"},r.a.createElement(_,{location:"game"}),r.a.createElement(R,{questions:this.randomizer(e)})):r.a.createElement(A,null)}}]),t}(n.Component),Q=Object(i.b)((function(e){return{token:e.player.token,questions:e.game.results,parameters:e.settings.parameters}}),(function(e){return{getQuestions:function(t,a){return e(function(e,t){return function(a){var n,r,c,s,i,o;return d.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return n=t.difficulty,r=t.categoryId,c=t.type,s="https://opentdb.com/api.php?amount=5&category=".concat(r,"&difficulty=").concat(n,"&type=").concat(c,"&token=").concat(e,"&encode=base64"),l.prev=2,a({type:"REQUEST_QUESTIONS"}),l.next=6,d.a.awrap(fetch(s));case 6:return i=l.sent,l.next=9,d.a.awrap(i.json());case 9:o=l.sent,console.log(o.results),a({type:"RECEIVE_QUESTIONS",payload:o.results}),l.next=17;break;case 14:l.prev=14,l.t0=l.catch(2),a(v(l.t0));case 17:case"end":return l.stop()}}),null,null,[[2,14]])}}(t,a))}}}))(U),F=a(40),M=function(e){function t(){var e;return Object(p.a)(this,t),(e=Object(b.a)(this,Object(f.a)(t).call(this))).state={shouldRedirect:!1},e.redirect=e.redirect.bind(Object(E.a)(e)),e.addNewRank=e.addNewRank.bind(Object(E.a)(e)),e}return Object(g.a)(t,e),Object(h.a)(t,[{key:"redirect",value:function(){this.setState({shouldRedirect:!0})}},{key:"addNewRank",value:function(){var e=this.props,t=e.newRank,a=e.name,n=e.email,r=e.score,c=Object(F.MD5)(n).toString();t(a,r,"https://www.gravatar.com/avatar/".concat(c))}},{key:"render",value:function(){var e=this,t=this.props,a=t.testid,n=t.inner,c=t.to,s=t.reset,i=t.className;return this.state.shouldRedirect?r.a.createElement(l.a,{to:c}):r.a.createElement("button",{"data-testid":a,type:"button",onClick:function(){e.redirect(),"/ranking"===c?e.addNewRank():s()},className:i},n)}}]),t}(n.Component),G=Object(i.b)((function(e){return{name:e.player.name,email:e.player.email,score:e.game.score}}),(function(e){return{newRank:function(t,a,n){return e(function(e,t,a){return function(n){var r;return d.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:n(N(e,t,a)),r=JSON.parse(localStorage.getItem("ranking")),localStorage.setItem("ranking",JSON.stringify([].concat(Object(k.a)(r),[{name:e,score:t,picture:a}])));case 3:case"end":return c.stop()}}))}}(t,a,n))},reset:function(){return e({type:"RESET_GAME"})}}}))(M),V=function(e){function t(){var e;return Object(p.a)(this,t),(e=Object(b.a)(this,Object(f.a)(t).call(this))).renderButtons=e.renderButtons.bind(Object(E.a)(e)),e}return Object(g.a)(t,e),Object(h.a)(t,[{key:"renderButtons",value:function(){return r.a.createElement("div",null,r.a.createElement(G,{testid:"btn-play-again",inner:"Jogar novamente!",to:"/",className:"btn btn-info"}),r.a.createElement(G,{testid:"btn-ranking",inner:"Ver ranking",to:"/ranking",className:"btn btn-dark"}))}},{key:"render",value:function(){var e=this.props,t=e.assertions,a=e.score;return r.a.createElement("main",{className:"feedback-page d-flex"},r.a.createElement(_,{location:"feedback"}),r.a.createElement("div",{className:"feedback-container position-absolute d-flex flex-column"},r.a.createElement("h1",{"data-testid":"feedback-text",className:"feedback-text position-absolute"},t<3?"Podia ser melhor...":"Mandou bem!"),r.a.createElement("h3",{"data-testid":"feedback-total-score"},"Sua pontua\xe7\xe3o foi:"," ",r.a.createElement("span",{className:t<3?"low-assertions":"high-assertions"},a)),r.a.createElement("h4",{"data-testid":"feedback-total-question"},"Voc\xea acertou"," ",r.a.createElement("span",{className:t<3?"low-assertions":"high-assertions"},t)," ","de 5 perguntas"),this.renderButtons()))}}]),t}(n.Component),q=Object(i.b)((function(e){return{assertions:e.game.assertions,score:e.game.score}}))(V),J=function(e){function t(){var e;return Object(p.a)(this,t),(e=Object(b.a)(this,Object(f.a)(t).call(this))).state={parameters:{type:"",difficulty:"",categoryId:0},redirect:!1},e.handleChange=e.handleChange.bind(Object(E.a)(e)),e}return Object(g.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){(0,this.props.getCategories)()}},{key:"handleChange",value:function(e){var t=e.target,a=t.name,n=t.value,r=this.state.parameters;this.setState({parameters:Object(y.a)({},r,Object(u.a)({},a,n))})}},{key:"render",value:function(){var e=this,t=this.props,a=t.setParams,n=t.categories,c=t.loading,s=this.state,i=s.parameters,o=s.redirect;return c?r.a.createElement(A,null):o?r.a.createElement(l.a,{to:"/"}):r.a.createElement("main",{className:"settings-screen d-flex"},r.a.createElement("div",{className:"outter-container d-flex"},r.a.createElement("div",{className:"settings-container d-flex flex-column"},r.a.createElement("h1",{"data-testid":"settings-title",className:"settings-title"},"Configura\xe7\xf5es"),r.a.createElement("label",{htmlFor:"category-select",className:"form-label"},"Categoria",r.a.createElement("select",{name:"categoryId",id:"category-select",onChange:this.handleChange,className:"form-select"},r.a.createElement("option",{value:""},"Todas"),n.map((function(e){var t=e.id,a=e.name;return r.a.createElement("option",{value:t,key:t},a)})))),r.a.createElement("label",{htmlFor:"diff-select",className:"form-label"},"Dificuldade",r.a.createElement("select",{name:"difficulty",id:"difficulty-select",onChange:this.handleChange,className:"form-select"},r.a.createElement("option",{value:""},"Todas"),r.a.createElement("option",{value:"easy"},"F\xe1cil"),r.a.createElement("option",{value:"medium"},"M\xe9dia"),r.a.createElement("option",{value:"hard"},"Dif\xedcil"))),r.a.createElement("label",{htmlFor:"type-select",className:"form-label"},"Tipo",r.a.createElement("select",{name:"type",id:"type-select",onChange:this.handleChange,className:"form-select"},r.a.createElement("option",{value:""},"Todas"),r.a.createElement("option",{value:"multiple"},"M\xfaltipla escolha"),r.a.createElement("option",{value:"boolean"},"Verdadeiro / Falso"))),r.a.createElement("div",null,r.a.createElement("button",{type:"button",onClick:function(){a(i),e.setState({redirect:!0})},className:"btn btn-dark"},"Configurar")))))}}]),t}(n.Component),D=Object(i.b)((function(e){return{categories:e.settings.categories,loading:e.settings.loading}}),(function(e){return{setParams:function(t){return e({type:"SET_PARAMS",payload:t})},getCategories:function(){return e((function(e){var t,a;return d.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return e({type:"REQUEST_CATEGORIES"}),n.prev=2,n.next=5,d.a.awrap(fetch("https://opentdb.com/api_category.php"));case 5:return t=n.sent,n.next=8,d.a.awrap(t.json());case 8:a=n.sent,e({type:"RECEIVE_CATEGORIES",payload:a.trivia_categories}),n.next=15;break;case 12:n.prev=12,n.t0=n.catch(2),j(n.t0);case 15:case"end":return n.stop()}}),null,null,[[2,12]])}))}}}))(J),L=function(e){function t(){return Object(p.a)(this,t),Object(b.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=JSON.parse(localStorage.getItem("ranking"));return console.log(e),r.a.createElement("main",{className:"ranking-page d-flex flex-column position-absolute"},r.a.createElement(_,{location:"ranking"}),r.a.createElement("div",{className:"ranking-container d-flex flex-column position-absolute"},r.a.createElement("h1",{"data-testid":"ranking-title",className:"ranking-title"},"Ranking"),r.a.createElement("div",{className:"ranking-list"},e.sort((function(e,t){return t.score-e.score})).map((function(e,t){var a=e.name,n=e.score,c=e.picture;return r.a.createElement("div",{key:"name-".concat(t),className:"ranking row"},r.a.createElement("img",{src:c,alt:"".concat(a," avatar")}),r.a.createElement("h3",{"data-testid":"player-name-".concat(t)},a),r.a.createElement("h3",{"data-testid":"player-score-".concat(t)},n))}))),r.a.createElement(G,{testid:"btn-go-home",inner:"Voltar ao in\xedcio",to:"/",className:"btn btn-info"})))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var B=a(24),z=a(41),P=a(42),K={name:"",email:"",token:"",loading:!1,error:null},W=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"REQUEST_TOKEN":return Object(y.a)({},e,{loading:!0});case"RECEIVE_TOKEN":return Object(y.a)({},e,{loading:!1,token:t.payload});case"FAIL_REQUEST":return Object(y.a)({},e,{loading:!1,error:t.payload});case"GET_NAME_EMAIL":return Object(y.a)({},e,{name:t.name,email:t.email});default:return e}},$={results:[],assertions:0,score:0,loading:!1},X=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"REQUEST_QUESTIONS":return Object(y.a)({},e,{loading:!0});case"FAIL_REQUEST_QUESTIONS":return Object(y.a)({},e,{error:t.payload,loading:!1});case"RECEIVE_QUESTIONS":return Object(y.a)({},e,{results:t.payload,loading:!1});case"UPDATE_SCORE":return Object(y.a)({},e,{score:e.score+t.payload});case"INCREASE_ASSERTIONS":return Object(y.a)({},e,{assertions:e.assertions+1});case"RESET_GAME":return Object(y.a)({},e,{results:[],score:0,assertions:0});default:return e}},H={playerName:"",score:0,picture:""},Y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NEW_RANK":return Object(y.a)({},e,{playerName:t.name,score:t.score,picture:t.picture});default:return e}},Z={parameters:{categoryId:0,difficulty:"",type:""},categories:[],loading:!1},ee=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"REQUEST_CATEGORIES":return Object(y.a)({},e,{loading:!0});case"RECEIVE_CATEGORIES":return Object(y.a)({},e,{categories:t.payload,loading:!1});case"RECEIVE_CATEGORIES_ERROR":return Object(y.a)({},e,{error:t.payload,loading:!1});case"SET_PARAMS":return Object(y.a)({},e,{parameters:t.payload});default:return e}},te=Object(B.combineReducers)({player:W,game:X,ranking:Y,settings:ee}),ae=Object(B.createStore)(te,Object(z.composeWithDevTools)(Object(B.applyMiddleware)(P.a))),ne=ae;window.Cypress&&(window.store=ae),s.a.render(r.a.createElement(i.a,{store:ne},r.a.createElement(o.a,null,r.a.createElement((function(){return r.a.createElement(l.d,null,r.a.createElement(l.b,{path:"/settings",component:D}),r.a.createElement(l.b,{path:"/game",component:Q}),r.a.createElement(l.b,{path:"/feedbacks",component:q}),r.a.createElement(l.b,{path:"/ranking",component:L}),r.a.createElement(l.b,{exact:!0,path:"/",component:w}))}),null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[43,1,2]]]);
//# sourceMappingURL=main.ecbfa95a.chunk.js.map